# CareerPassport 設計書

## 📋 目次

1. [システムアーキテクチャ](#システムアーキテクチャ)
2. [データフロー](#データフロー)
3. [UI/UX 設計](#uiux-設計)
4. [スマートコントラクト設計](#スマートコントラクト設計)
5. [技術スタック](#技術スタック)

---

## システムアーキテクチャ

### 全体構成

```
┌─────────────────────────────────────────┐
│         Frontend (React + Vite)         │
│                                         │
│  ┌──────────┐  ┌──────────┐          │
│  │  Student │  │Organization│         │
│  │    UI    │  │    UI     │          │
│  └──────────┘  └──────────┘          │
│         │              │                │
│         └──────┬───────┘                │
│                │                        │
│         ┌─────▼─────┐                  │
│         │  Wallet   │                  │
│         │  Connect  │                  │
│         └─────┬─────┘                  │
└───────────────┼────────────────────────┘
                │
                │ (MetaMask)
                │
┌───────────────▼────────────────────────┐
│    Local Blockchain (Anvil)            │
│                                         │
│  ┌──────────────┐  ┌──────────────┐   │
│  │  NFT Contract│  │Stamp Manager │   │
│  │  (ERC721)    │  │  Contract    │   │
│  └──────────────┘  └──────────────┘   │
└─────────────────────────────────────────┘
```

### コンポーネント構成

```
frontend/
├── src/
│   ├── pages/
│   │   ├── Home.jsx              # ホーム画面
│   │   ├── MyPage.jsx            # マイページ（スタンプ一覧）
│   │   ├── MyNFTs.jsx            # NFT 一覧
│   │   ├── NFTDetail.jsx         # NFT 詳細
│   │   ├── OrgDashboard.jsx      # 企業ダッシュボード
│   │   └── OrgStampIssuance.jsx  # スタンプ発行
│   ├── components/
│   │   ├── Layout.jsx           # レイアウト
│   │   ├── Navigation.jsx        # ナビゲーション
│   │   ├── WalletConnect.jsx     # ウォレット接続
│   │   ├── StampCard.jsx         # スタンプカード
│   │   ├── NFTCard.jsx           # NFT カード
│   │   └── ProgressBar.jsx      # 進捗バー
│   ├── hooks/
│   │   ├── useWallet.js          # ウォレットフック
│   │   └── useStamps.js          # スタンプフック
│   ├── lib/
│   │   ├── contracts.js          # コントラクト接続
│   │   └── storage.js            # ローカルストレージ
│   ├── data/
│   │   └── mockData.js           # モックデータ
│   └── router.jsx                # ルーティング
```

---

## データフロー

### スタンプ発行フロー

```
企業ユーザー
    │
    ├─> スタンプ発行画面
    │       │
    │       ├─> スタンプ情報入力
    │       │   (名前、企業名、カテゴリ)
    │       │
    │       └─> ウォレット接続確認
    │               │
    │               ├─> MetaMask でトランザクション承認
    │               │
    │               └─> StampManager コントラクト呼び出し
    │                       │
    │                       └─> ブロックチェーンに記録
    │                               │
    │                               └─> イベント発火
    │                                       │
    │                                       └─> UI 更新
```

### NFT 交換フロー

```
学生ユーザー
    │
    ├─> マイページ
    │       │
    │       ├─> スタンプ一覧表示
    │       │   (企業別に集計)
    │       │
    │       └─> NFT 交換可能判定
    │               │
    │               ├─> 同じ企業のスタンプ 3 つ以上？
    │               │       │
    │               │       ├─> YES → 交換ボタン表示
    │               │       │
    │               │       └─> NO → 進捗バー表示
    │               │
    │               └─> 交換ボタンクリック
    │                       │
    │                       ├─> MetaMask でトランザクション承認
    │                       │
    │                       └─> NFT コントラクト呼び出し
    │                               │
    │                               ├─> NFT 発行
    │                               │
    │                               └─> UI 更新
```

---

## UI/UX 設計

### 画面一覧

#### 1. ホーム画面 (`/`)

**レイアウト**:

```
┌─────────────────────────────────────┐
│  CareerPassport 🎫                 │
│  [ウォレット接続]                    │
├─────────────────────────────────────┤
│  👤 ユーザー名                       │
│                                     │
│  📊 現在のスタンプ数: 8 枚          │
│  🏆 NFT 証明書: 2 枚               │
│                                     │
│  ┌─────────────────────────────┐  │
│  │ 🎯 次の目標                   │  │
│  │                               │  │
│  │ 野村證券認定 NFT まで          │  │
│  │ あと 1 スタンプ！              │  │
│  │ [■■■□] 75%                  │  │
│  └─────────────────────────────┘  │
│                                     │
│  最近のスタンプ:                     │
│  🎫 野村證券 投資分析コンペ         │
│  🎫 電通 マーケティング講座         │
│  🎫 三菱商事 グローバル研修         │
│                                     │
│  [マイページ] [イベント検索]         │
└─────────────────────────────────────┘
```

#### 2. マイページ (`/mypage`)

**レイアウト**:

```
┌─────────────────────────────────────┐
│  💼 マイスタンプ                     │
├─────────────────────────────────────┤
│  【野村證券】2/3                    │
│  🎫 金融セミナー 2024/06            │
│  🎫 投資コンペ 2024/09              │
│  ⬜ あと 1 つで認定 NFT！           │
│                                     │
│  【電通】1/3                        │
│  🎫 マーケティング講座 2024/08      │
│  ⬜ ⬜                              │
│                                     │
│  🏆 取得した NFT 証明書              │
│  ┌─────────────────┐              │
│  │ 金融リテラシー NFT │              │
│  │ ⭐⭐⭐ (Rare)    │              │
│  └─────────────────┘              │
└─────────────────────────────────────┘
```

#### 3. NFT 詳細画面 (`/nft/:id`)

**レイアウト**:

```
┌─────────────────────────────────────┐
│  🏆 NFT 証明書                      │
├─────────────────────────────────────┤
│  ┌─────────────────────┐          │
│  │                     │          │
│  │ 野村證券認定 NFT     │          │
│  │ 💰✨                │          │
│  │                     │          │
│  │ 発行日: 2024/12/01  │          │
│  │ レアリティ: Common  │          │
│  │ シリアル: #5678     │          │
│  └─────────────────────┘          │
│                                     │
│  取得条件:                          │
│  ✅ 野村證券金融セミナー            │
│  ✅ 野村證券投資分析コンペ          │
│  ✅ 野村證券インターン              │
│                                     │
│  [共有する] [詳細を見る]            │
└─────────────────────────────────────┘
```

#### 4. 企業ダッシュボード (`/org`)

**レイアウト**:

```
┌─────────────────────────────────────┐
│  企業管理画面                        │
│  野村證券株式会社                    │
├─────────────────────────────────────┤
│  📊 ダッシュボード                   │
│  発行済みスタンプ: 2,345 枚          │
│  参加学生数: 789 人                 │
│  NFT 発行数: 156 枚                 │
│                                     │
│  📝 スタンプ発行                     │
│  [新しいスタンプを作成]              │
│                                     │
│  📋 最近の発行                       │
│  🎫 投資分析セミナー (120 人)        │
│  🎫 金融リテラシー講座 (89 人)      │
└─────────────────────────────────────┘
```

---

## スマートコントラクト設計

### CareerPassportNFT.sol

**機能**:

- ERC721 準拠の NFT 発行
- 譲渡不可機能
- メタデータ管理（名前、レアリティ、企業情報）

**主要関数**:

```solidity
function mint(
    address to,
    string memory tokenURI,
    string memory name,
    string memory rarity,
    string[] memory organizations
) public onlyOwner returns (uint256)
```

### StampManager.sol

**機能**:

- スタンプ発行
- スタンプ集計（企業別、カテゴリ別）
- NFT 交換条件判定

**主要関数**:

```solidity
function issueStamp(
    address user,
    string memory name,
    string memory organization,
    string memory category
) public onlyOwner

function canMintNFT(
    address user,
    string memory organization
) public view returns (bool)
```

---

## 技術スタック

### フロントエンド

- **React 19**: UI フレームワーク
- **Vite**: ビルドツール
- **React Router**: ルーティング
- **Ethers.js**: ブロックチェーン連携
- **LocalStorage**: 一時データ保存

### スマートコントラクト

- **Solidity 0.8.20**: コントラクト言語
- **Foundry**: 開発環境
- **OpenZeppelin**: セキュアなコントラクトライブラリ
- **Anvil**: ローカルブロックチェーン

### 開発ツール

- **MetaMask**: ウォレット
- **Git**: バージョン管理

---

**最終更新**: 2025 年 12 月 2 日
